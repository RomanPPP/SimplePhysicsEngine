let distSq = (x, y) => {
  return x.map((e, i) => e - y[i]).reduce((acc, e) => (acc += e ** 2), 0);
};

const GaussSeidel = (A, b, n, eps) => {
  let x = new Array(n).fill(0);
  let conv = false,
    maxIter = 64;
  let x_new = [];
  while (!conv && maxIter > 0) {
    maxIter--;
    x_new = [...x];
    for (let i = 0; i < n; i++) {
      let s = 0;
      for (let j = 0; j < i; j++) {
        s += A[i * n + j] * x_new[j];
      }
      for (let j = i + 1; j < n; j++) {
        s += A[i * n + j] * x[j];
      }
      x_new[i] = (b[i] - s) / A[i * n + i];
    }

    conv = distSq(x, x_new) < eps;
    x = [...x_new];
  }
  return x_new;
};
export { GaussSeidel };
